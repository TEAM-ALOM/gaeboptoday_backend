generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  studentCode String @id @unique
  name String @unique
  review Review[]
}

model Menu {
  name String @unique() @id
  review Review[]
  lunches Daily[] @relation("daily_lunch")
  dinners Daily[] @relation("daily_dinner")
}

model Daily {
  id     String   @id @unique @default(uuid())
  weekly Weekly?     @relation(fields: [weeklyId], references: [id], onDelete: SetNull)
  weeklyId String? 
  lunch  Menu[] @relation("daily_lunch")
  dinner Menu[] @relation("daily_dinner")
}

model Review {
  id Int @id @unique @default(autoincrement())
  menu Menu? @relation(fields: [menu_name], references: [name], onDelete: Cascade)
  menu_name String?
  writer User? @relation(fields: [writer_id], references: [studentCode], onDelete: Cascade)
  writer_id String?
}

model Data {
  id      String @id @unique @default(uuid())
  content Weekly[]
  createdAt DateTime @default(now()) @db.Timestamptz(3)
}

model Weekly {
  id      String      @id @unique @default(uuid())
  data    Data?        @relation(fields: [dataId], references: [id], onDelete: SetNull)
  dataId  String?
  day     DoW
  content Daily[]
}

enum DoW {
  Mon
  Tue
  Wed
  Thu
  Fri
  Sat
  Sun
}
